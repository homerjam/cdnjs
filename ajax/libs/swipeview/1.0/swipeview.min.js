var SwipeView=function(a,b){function t(a){return""===d?a:(a=a.charAt(0).toUpperCase()+a.substr(1),d+a)}var c=b.createElement("div").style,d=function(){for(var b,a="t,webkitT,MozT,msT,OT".split(","),d=0,e=a.length;e>d;d++)if(b=a[d]+"ransform",b in c)return a[d].substr(0,a[d].length-1);return!1}(),e=d?"-"+d.toLowerCase()+"-":"",f=t("transform"),g=t("transitionDuration"),h=t("perspective")in c,i="ontouchstart"in a,l=(t("transition")in c,h?" translateZ(0)":""),m="onorientationchange"in a?"orientationchange":"resize",n=i?"touchstart":"mousedown",o=i?"touchmove":"mousemove",p=i?"touchend":"mouseup",q=i?"touchcancel":"mouseup",r=function(){if(d===!1)return!1;var a={"":"transitionend",webkit:"webkitTransitionEnd",Moz:"transitionend",O:"oTransitionEnd",ms:"MSTransitionEnd"};return a[d]}(),s=function(c,f){var g,h,i,j;this.wrapper="string"==typeof c?b.querySelector(c):c,this.options={text:null,numberOfPages:3,snapThreshold:null,hastyPageFlip:!1,loop:!0};for(g in f)this.options[g]=f[g];for(this.wrapper.style.overflow="hidden",this.wrapper.style.position="relative",this.masterPages=[],h=b.createElement("div"),h.id="swipeview-slider",h.style.cssText="position:relative;top:0;height:100%;width:100%;"+e+"transition-duration:0;"+e+"transform:translateZ(0);"+e+"transition-timing-function:ease-out",this.wrapper.appendChild(h),this.slider=h,this.refreshSize(),g=-1;2>g;g++)h=b.createElement("div"),h.id="swipeview-masterpage-"+(g+1),h.style.cssText=e+"transform:translateZ(0);position:absolute;top:0;height:100%;width:100%;left:"+100*g+"%",h.dataset||(h.dataset={}),j=-1==g?this.options.numberOfPages-1:g,h.dataset.pageIndex=j,h.dataset.upcomingPageIndex=j,this.options.loop||-1!=g||(h.style.visibility="hidden"),this.slider.appendChild(h),this.masterPages.push(h);i=this.masterPages[1].className,this.masterPages[1].className=i?i+" swipeview-active":"swipeview-active",a.addEventListener(m,this,!1),this.wrapper.addEventListener(n,this,!1),this.wrapper.addEventListener(o,this,!1),this.wrapper.addEventListener(p,this,!1),this.slider.addEventListener(r,this,!1),"O"==d&&this.slider.addEventListener(r.toLowerCase(),this,!1)};return s.prototype={currentMasterPage:1,x:0,page:0,pageIndex:0,customEvents:[],onFlip:function(a){this.wrapper.addEventListener("swipeview-flip",a,!1),this.customEvents.push(["flip",a])},onMoveOut:function(a){this.wrapper.addEventListener("swipeview-moveout",a,!1),this.customEvents.push(["moveout",a])},onMoveIn:function(a){this.wrapper.addEventListener("swipeview-movein",a,!1),this.customEvents.push(["movein",a])},onTouchStart:function(a){this.wrapper.addEventListener("swipeview-touchstart",a,!1),this.customEvents.push(["touchstart",a])},destroy:function(){for(;this.customEvents.length;)this.wrapper.removeEventListener("swipeview-"+this.customEvents[0][0],this.customEvents[0][1],!1),this.customEvents.shift();a.removeEventListener(m,this,!1),this.wrapper.removeEventListener(n,this,!1),this.wrapper.removeEventListener(o,this,!1),this.wrapper.removeEventListener(p,this,!1),this.slider.removeEventListener(r,this,!1)},refreshSize:function(){this.wrapperWidth=this.wrapper.clientWidth,this.wrapperHeight=this.wrapper.clientHeight,this.pageWidth=this.wrapperWidth,this.maxX=-this.options.numberOfPages*this.pageWidth+this.wrapperWidth,this.snapThreshold=null===this.options.snapThreshold?Math.round(.15*this.pageWidth):/%/.test(this.options.snapThreshold)?Math.round(this.pageWidth*this.options.snapThreshold.replace("%","")/100):this.options.snapThreshold},updatePageCount:function(a){this.options.numberOfPages=a,this.maxX=-this.options.numberOfPages*this.pageWidth+this.wrapperWidth},goToPage:function(a){var b;for(this.masterPages[this.currentMasterPage].className=this.masterPages[this.currentMasterPage].className.replace(/(^|\s)swipeview-active(\s|$)/,""),b=0;3>b;b++)className=this.masterPages[b].className,/(^|\s)swipeview-loading(\s|$)/.test(className)||(this.masterPages[b].className=className?className+" swipeview-loading":"swipeview-loading");a=0>a?0:a>this.options.numberOfPages-1?this.options.numberOfPages-1:a,this.page=a,this.pageIndex=a,this.slider.style[g]="0s",this.__pos(-a*this.pageWidth),this.currentMasterPage=this.page+1-3*Math.floor((this.page+1)/3),this.masterPages[this.currentMasterPage].className=this.masterPages[this.currentMasterPage].className+" swipeview-active",0===this.currentMasterPage?(this.masterPages[2].style.left=100*this.page-100+"%",this.masterPages[0].style.left=100*this.page+"%",this.masterPages[1].style.left=100*this.page+100+"%",this.masterPages[2].dataset.upcomingPageIndex=0===this.page?this.options.numberOfPages-1:this.page-1,this.masterPages[0].dataset.upcomingPageIndex=this.page,this.masterPages[1].dataset.upcomingPageIndex=this.page==this.options.numberOfPages-1?0:this.page+1):1==this.currentMasterPage?(this.masterPages[0].style.left=100*this.page-100+"%",this.masterPages[1].style.left=100*this.page+"%",this.masterPages[2].style.left=100*this.page+100+"%",this.masterPages[0].dataset.upcomingPageIndex=0===this.page?this.options.numberOfPages-1:this.page-1,this.masterPages[1].dataset.upcomingPageIndex=this.page,this.masterPages[2].dataset.upcomingPageIndex=this.page==this.options.numberOfPages-1?0:this.page+1):(this.masterPages[1].style.left=100*this.page-100+"%",this.masterPages[2].style.left=100*this.page+"%",this.masterPages[0].style.left=100*this.page+100+"%",this.masterPages[1].dataset.upcomingPageIndex=0===this.page?this.options.numberOfPages-1:this.page-1,this.masterPages[2].dataset.upcomingPageIndex=this.page,this.masterPages[0].dataset.upcomingPageIndex=this.page==this.options.numberOfPages-1?0:this.page+1),this.__flip()},next:function(){(this.options.loop||this.x!=this.maxX)&&(this.directionX=-1,this.x-=1,this.__checkPosition())},prev:function(){(this.options.loop||0!==this.x)&&(this.directionX=1,this.x+=1,this.__checkPosition())},handleEvent:function(a){switch(a.type){case n:this.__start(a);break;case o:this.__move(a);break;case q:case p:this.__end(a);break;case m:this.__resize();break;case r:case"otransitionend":a.target!=this.slider||this.options.hastyPageFlip||this.__flip()}},__pos:function(a){this.x=a,this.slider.style[f]="translate("+a+"px,0)"+l},__resize:function(){this.refreshSize(),this.slider.style[g]="0s",this.__pos(-this.page*this.pageWidth)},__start:function(a){if(!this.initiated){var b=i?a.touches[0]:a;this.initiated=!0,this.moved=!1,this.thresholdExceeded=!1,this.startX=b.pageX,this.startY=b.pageY,this.pointX=b.pageX,this.pointY=b.pageY,this.stepsX=0,this.stepsY=0,this.directionX=0,this.directionLocked=!1,this.slider.style[g]="0s",this.__event("touchstart")}},__move:function(a){if(this.initiated){var b=i?a.touches[0]:a,c=b.pageX-this.pointX,d=b.pageY-this.pointY,e=this.x+c,f=Math.abs(b.pageX-this.startX);if(this.moved=!0,this.pointX=b.pageX,this.pointY=b.pageY,this.directionX=c>0?1:0>c?-1:0,this.stepsX+=Math.abs(c),this.stepsY+=Math.abs(d),!(this.stepsX<10&&this.stepsY<10)){if(!this.directionLocked&&this.stepsY>this.stepsX)return this.initiated=!1,void 0;a.preventDefault(),this.directionLocked=!0,!this.options.loop&&(e>0||e<this.maxX)&&(e=this.x+c/2),!this.thresholdExceeded&&f>=this.snapThreshold?(this.thresholdExceeded=!0,this.__event("moveout")):this.thresholdExceeded&&f<this.snapThreshold&&(this.thresholdExceeded=!1,this.__event("movein")),this.__pos(e)}}},__end:function(a){if(this.initiated){var b=i?a.changedTouches[0]:a,c=Math.abs(b.pageX-this.startX);if(this.initiated=!1,this.moved)return!this.options.loop&&(this.x>0||this.x<this.maxX)&&(c=0,this.__event("movein")),c<this.snapThreshold?(this.slider.style[g]=Math.floor(300*c/this.snapThreshold)+"ms",this.__pos(-this.page*this.pageWidth),void 0):(this.__checkPosition(),void 0)}},__checkPosition:function(){var a,b,c;this.masterPages[this.currentMasterPage].className=this.masterPages[this.currentMasterPage].className.replace(/(^|\s)swipeview-active(\s|$)/,""),this.directionX>0?(this.page=-Math.ceil(this.x/this.pageWidth),this.currentMasterPage=this.page+1-3*Math.floor((this.page+1)/3),this.pageIndex=0===this.pageIndex?this.options.numberOfPages-1:this.pageIndex-1,a=this.currentMasterPage-1,a=0>a?2:a,this.masterPages[a].style.left=100*this.page-100+"%",b=this.page-1):(this.page=-Math.floor(this.x/this.pageWidth),this.currentMasterPage=this.page+1-3*Math.floor((this.page+1)/3),this.pageIndex=this.pageIndex==this.options.numberOfPages-1?0:this.pageIndex+1,a=this.currentMasterPage+1,a=a>2?0:a,this.masterPages[a].style.left=100*this.page+100+"%",b=this.page+1),c=this.masterPages[this.currentMasterPage].className,/(^|\s)swipeview-active(\s|$)/.test(c)||(this.masterPages[this.currentMasterPage].className=c?c+" swipeview-active":"swipeview-active"),c=this.masterPages[a].className,/(^|\s)swipeview-loading(\s|$)/.test(c)||(this.masterPages[a].className=c?c+" swipeview-loading":"swipeview-loading"),b-=Math.floor(b/this.options.numberOfPages)*this.options.numberOfPages,this.masterPages[a].dataset.upcomingPageIndex=b,newX=-this.page*this.pageWidth,this.slider.style[g]=Math.floor(500*Math.abs(this.x-newX)/this.pageWidth)+"ms",this.options.loop||(this.masterPages[a].style.visibility=0===newX||newX==this.maxX?"hidden":""),this.x==newX?this.__flip():(this.__pos(newX),this.options.hastyPageFlip&&this.__flip())},__flip:function(){this.__event("flip");for(var a=0;3>a;a++)this.masterPages[a].className=this.masterPages[a].className.replace(/(^|\s)swipeview-loading(\s|$)/,""),this.masterPages[a].dataset.pageIndex=this.masterPages[a].dataset.upcomingPageIndex},__event:function(a){var c=b.createEvent("Event");c.initEvent("swipeview-"+a,!0,!0),this.wrapper.dispatchEvent(c)}},s}(window,document);